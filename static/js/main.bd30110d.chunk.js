(window.webpackJsonptfclassifier=window.webpackJsonptfclassifier||[]).push([[0],{104:function(e,t){},106:function(e,t){},140:function(e,t){},141:function(e,t){},183:function(e,t){},184:function(e,t){},185:function(e,t){},186:function(e,t,n){},187:function(e,t,n){"use strict";n.r(t);var r=n(4),a=n.n(r),i=n(90),o=n.n(i),s=(n(99),n(3)),c=n.n(s),u=n(91),l=n(8),d=n(48),p=n(49),f=n(88),h=n(50),v=n(89),m=n(92),b=n(93),g=n(5);n(186);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(n,!0).forEach(function(t){Object(u.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var C=a.a.lazy(function(){return n.e(3).then(n.bind(null,188))}),k=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(f.a)(this,Object(h.a)(t).call(this,e))).updateState=function(){var e=Object(l.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.setState(y({},n.state,{},t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.loadingContainer=a.a.createRef(),n.results=a.a.createRef(),n.classifier=m.a(),n.loadingInterval=null,n.state={netModel:null,classes:["A","B","C","Reset"],classCount:0,modelLoading:"Loading ...",mediaControlReady:!1,showDetails:!1,videoSize:{width:"80%",height:"80%"},updateInstructionsState:function(){var e=Object(l.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=getComputedStyle(document.querySelector(".instructions")).getPropertyValue("--showInstructions"),e.next=4,n.updateState({showDetails:"true"===t});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log("Error caused at updateInstructionsState() : ".concat(e.t0));case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(){return e.apply(this,arguments)}}(),updateVideoSize:function(){var e=Object(l.a)(c.a.mark(function e(){var t,r,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=getComputedStyle(document.querySelector(".videoContainer")),r=t.getPropertyValue("--videoWidth"),a=t.getPropertyValue("--videoHeight"),e.next=6,n.updateState({videoSize:{width:r,height:a}});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Error caused at updateVideoSize() : ".concat(e.t0));case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(){return e.apply(this,arguments)}}()},n}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(l.a)(c.a.mark(function e(){var t=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.addEventListener("resize",function(){return t.screenResize()}),document.title="ML Classifier App",this.checkOnlineStatusAndLoadApp();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){var e=this;this.classifier=null,this.loadingInterval=null,this.videoElement=null,window.removeEventListener("resize",function(){return e.screenResize()})}},{key:"checkOnlineStatusAndLoadApp",value:function(){var e=Object(l.a)(c.a.mark(function e(){var t,n,r=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=navigator.onLine,n=function(){var e=Object(l.a)(c.a.mark(function e(){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=navigator.onLine,console.log("navigator online state: ".concat(t)),e.next=4,r.updateState({modelLoading:"Loading ..."});case 4:(n=r.loadingContainer.current).innerHTML="",n.className="loadingContainer",r.loadApp();case 8:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),window.addEventListener("online",n),e.next=5,n();case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"loadApp",value:function(){var e=Object(l.a)(c.a.mark(function e(){var t=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.loadMLModel();case 3:return e.next=5,this.updateState({modelLoading:""});case 5:setTimeout(Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.screenResize();case 2:case"end":return e.stop()}},e)})),1e3),this.runClassifier(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.dir("error caused: ".concat(e.t0));case 12:return e.prev=12,console.log("model loading in app completed.."),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[0,9,12,15]])}));return function(){return e.apply(this,arguments)}}()},{key:"loadMLModel",value:function(){var e=Object(l.a)(c.a.mark(function e(){var t=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(l.a)(c.a.mark(function e(n,r){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Loading mobilenet.."),e.prev=1,e.next=4,b.a();case 4:return a=e.sent,e.next=7,t.updateState({netModel:a});case 7:return console.log("Sucessfully loaded model"),e.abrupt("return",n());case 11:return e.prev=11,e.t0=e.catch(1),console.log("model mobilenet could not be loaded.."),e.abrupt("return",r());case 15:case"end":return e.stop()}},e,null,[[1,11]])}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"runClassifier",value:function(){var e=Object(l.a)(c.a.mark(function e(){var t,n,r,a,i,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("classifier started..."),t=this.state.netModel;case 2:if(!(this.classifier.getNumClasses()>0)){e.next=14;break}return n=t.infer(this.videoElement.videoElement,"conv_preds"),e.next=7,this.classifier.predictClass(n);case 7:r=e.sent,a=this.state.classes,i={prediction:a[r.classIndex],probability:null!==r.confidences[r.classIndex]&&void 0!==r.confidences[r.classIndex]?100*r.confidences[r.classIndex]:0},o="",void 0!==i.prediction&&(o="<ul><li>Prediction&nbsp;&nbsp;: ".concat(i.prediction," </li><li>Probability&nbsp;: ").concat(i.probability+"%"," </li></ul>")),this.results.current.innerHTML=o,this.results.current.style.visibility=""!==o.trim()?"visible":"hidden";case 14:return e.next=16,g.nextFrame();case 16:e.next=2;break;case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"addExample",value:function(){var e=Object(l.a)(c.a.mark(function e(t){var n,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=this.state.netModel)||!(this.classifier.getNumClasses()>0&&t>0||this.classifier.getNumClasses()>=0&&0===t)){e.next=5;break}return r=n.infer(this.videoElement.videoElement,"conv_preds"),e.next=5,this.classifier.addExample(r,t);case 5:this.updateState({classCount:t+1>this.state.classCount?t+1:this.state.classCount});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"screenResize",value:function(){var e=Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("screenResize() called.."),e.next=3,this.state.updateVideoSize();case 3:return e.next=5,this.state.updateInstructionsState();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"headerComponent",value:function(){return a.a.createElement("h2",null,"Machine learning for video classification")}},{key:"videoComponent",value:function(){var e=this;return a.a.createElement(a.a.Suspense,{fallback:a.a.createElement("div",{className:"loadingContainer"},"Loading...")},a.a.createElement(C,{parentState:this.state,parentStateUpdate:function(){var t=Object(l.a)(c.a.mark(function t(n){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.updateState(n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),ref:function(t){return e.videoElement=t}}))}},{key:"buttonListComponent",value:function(){var e=this;return a.a.createElement("div",{className:"btnContainer"},this.state.classes.map(function(t,n){return a.a.createElement("button",{key:"btn".concat(t+n),ref:function(n){return e["btn".concat(t)]=n},onClick:function(r){"reset"!==t.toLowerCase()?e.addExample(n):(e.classifier.clearAllClasses(),e.updateState({classCount:0}),e.results.current.innerHTML="")},disabled:!("reset"===t.toLowerCase()&&e.state.classCount>0)&&(!(n<=e.state.classCount)||!e.state.mediaControlReady)},("reset"!==t.toLowerCase()?"Add ":"")+t)}))}},{key:"resultsComponent",value:function(){return a.a.createElement("div",{ref:this.results,className:"results"})}},{key:"instructionListComponent",value:function(){return a.a.createElement("div",{className:"instructions"},a.a.createElement("details",{open:this.state.showDetails},a.a.createElement("summary",null,"Instructions"),a.a.createElement("ul",null,["Snap multiple views using the available buttons(in presented order as A -> B -> C) to recognize and learn, for each button hit - it would start displaying prediction with probability subsequently","For instance, capture the tilting faces in directions for buttons as Add A(left), Add B(center) and Add C(right) mutiple times i.e. atleast 3 times each or more is recommended (prediction is certainly more accurate the more image snapshots are learned)","Try tilting faces from left to right freely to show expected predictions or refine it further by continuing with the respective buttons as desired","All of the data from camera stream is processed and recognized to learn locally and is not stored or accessed on any remote server"].map(function(e,t){return a.a.createElement("li",{key:t},e)}))))}},{key:"footerComponent",value:function(){return a.a.createElement("div",{className:"footer"},"Project available on github ",a.a.createElement("a",{href:"https://github.com/NileshSP/reactTfClassifier",target:"_blank",rel:"noopener noreferrer"},"@NileshSP/reactTfClassifier"))}},{key:"render",value:function(){return a.a.createElement("div",{className:"App"},a.a.createElement("div",{className:"mainContainer"},""===this.state.modelLoading?a.a.createElement("div",{className:"workingContainer"},this.headerComponent(),this.videoComponent(),this.buttonListComponent(),this.resultsComponent(),this.instructionListComponent(),this.footerComponent()):a.a.createElement("div",{className:"loadingContainer",ref:this.loadingContainer})))}}]),t}(r.Component),x=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function E(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.a.render(a.a.createElement(k,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/reactTfClassifier",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/reactTfClassifier","/").concat("offline.js");x?(!function(e,t){fetch(e).then(function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):E(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):E(t,e)})}}()},94:function(e,t,n){e.exports=n(187)},99:function(e,t,n){}},[[94,1,2]]]);
//# sourceMappingURL=main.bd30110d.chunk.js.map